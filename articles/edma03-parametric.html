<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parametric estimation • EDMAinR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Parametric estimation">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EDMAinR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/edma01-data.html">EDMA data</a>
    </li>
    <li>
      <a href="../articles/edma02-form.html">EDMA form matrix</a>
    </li>
    <li>
      <a href="../articles/edma03-parametric.html">Parametric estimation</a>
    </li>
    <li>
      <a href="../articles/edma04-form-difference.html">EDMA form difference matrix</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Parametric estimation</h1>
                        <h4 class="author">Peter Solymos</h4>
            
      
      
      <div class="hidden name"><code>edma03-parametric.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This tutorial describes how to estimate SigmaK and assess if it is estimable. Parametric estimation of SigmaK involves the following steps:</p>
<ol style="list-style-type: decimal">
<li>non-parametric estimation of mean form and SigmaKstar using the <code>edma_fit</code> function,</li>
<li>constructing of a pattern matrix based on biology of landmarks and respecting statistical constraints,</li>
<li>use the <code>SigmaK_fit</code> to estimate SigmaK using the non-parametric fit and the pattern matrix,</li>
<li>make sure the results are estimable by running <code>sensitivity</code> analysis.</li>
</ol>
</div>
<div id="simulated-landmark-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-landmark-data" class="anchor"></a>Simulated landmark data</h2>
<p>To demonstrate the workflow, let us simulate some data. Simulation is useful for checking the limits of the estimating procedure. We know what the ‘true’ input are, because we are controlling those through the simulation. We can then compare the outputs (our estimates), to the known imputs, and this is how we evaluate the utility and limitations of our methods.</p>
<p>Let us begin with the following set of 6 landmarks in 2-dimensions:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">(M &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">82</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">-50</span>, <span class="dv">-37</span>, <span class="dv">-37</span>, </a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  <span class="dv">0</span>,  <span class="dv">17</span>, <span class="dv">-17</span>, <span class="dv">0</span>,  <span class="dv">41</span>,  <span class="dv">-41</span>), </a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="dt">dim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">6</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="dt">dimnames=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"L"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"X"</span>, <span class="st">"Y"</span>))))</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;      X   Y</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; L1  82   0</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; L2  21  17</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; L3  22 -17</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; L4 -50   0</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; L5 -37  41</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; L6 -37 -41</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(M, <span class="dt">pch=</span><span class="dv">3</span>, <span class="dt">asp=</span><span class="dv">1</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">ann=</span><span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">"n"</span>)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(M, <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M), <span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="edma03-parametric_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>The simplest SigmaK variance-covariance matrix is <span class="math inline">\(\sigma^2 I\)</span>, that is constant variance (<span class="math inline">\(\sigma^2\)</span>) in the diagonal of the <span class="math inline">\(6\times6\)</span> square matrix and 0’s in all the off-diagonal cells:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">sigma &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">SigmaK &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(sigma<span class="op">^</span><span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(SigmaK) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M), <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">SigmaK</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;    L1 L2 L3 L4 L5 L6</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; L1  4  0  0  0  0  0</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; L2  0  4  0  0  0  0</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; L3  0  0  4  0  0  0</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; L4  0  0  0  4  0  0</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; L5  0  0  0  0  4  0</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; L6  0  0  0  0  0  4</span></a></code></pre></div>
<p>We can use the <code>edma_simulate_data</code> function to simulate <code>n</code> specimen given form matrix <code>M</code> and covariance matrix <code>SigmaK</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">sim &lt;-<span class="st"> </span><span class="kw">edma_simulate_data</span>(<span class="dt">n=</span>n, M, SigmaK)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">EDMAinR<span class="op">:::</span><span class="kw">.plot_edma_data</span>(sim, <span class="ot">NULL</span>, <span class="dt">asp=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">80</span>, <span class="dv">100</span>), <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">60</span>, <span class="dv">60</span>))</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(M[,<span class="dv">1</span>]<span class="op">-</span><span class="dv">15</span>, M[,<span class="dv">2</span>], <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"L"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">cex=</span><span class="fl">0.6</span>, <span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="edma03-parametric_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>We can see from the figure that the constant variance stranslates to roughly circle shaped convex hulls around the landmarks (the hull bounds the landmarks form the <code>n</code> specimens), and the size of these patches is similar (equal variances).</p>
</div>
<div id="nonparametruc-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#nonparametruc-estimation" class="anchor"></a>Nonparametruc estimation</h2>
<p>We use the non-parametric EDMA algorithm to estimate the form matrix and the SigmaKstar matrix:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">fit &lt;-<span class="st"> </span><span class="kw">edma_fit</span>(sim)</a></code></pre></div>
<p>Because we used simulations, we can compare the known <code>M</code> matrix with the estimated mean form:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">M                       <span class="co"># true</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt;      X   Y</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; L1  82   0</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; L2  21  17</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; L3  22 -17</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; L4 -50   0</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; L5 -37  41</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; L6 -37 -41</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw">Meanform</span>(fit), <span class="dv">2</span>) <span class="co"># estimate</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;         X      Y</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; L1 -81.87   0.12</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; L2 -20.80  17.10</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; L3 -21.89 -16.96</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; L4  50.30  -0.17</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; L5  37.20  40.95</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; L6  37.06 -41.03</span></a></code></pre></div>
<p>The ‘true’ <code>SigmaKstar</code> matrix is stored in our simulation object:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">tmp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(sim, <span class="st">"simulation_settings"</span>)<span class="op">$</span>SigmaKstar</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(tmp) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M), <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M))</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(tmp, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt;       L1    L2    L3    L4    L5    L6</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; L1  3.33 -0.67 -0.67 -0.67 -0.67 -0.67</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; L2 -0.67  3.33 -0.67 -0.67 -0.67 -0.67</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; L3 -0.67 -0.67  3.33 -0.67 -0.67 -0.67</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; L4 -0.67 -0.67 -0.67  3.33 -0.67 -0.67</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; L5 -0.67 -0.67 -0.67 -0.67  3.33 -0.67</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; L6 -0.67 -0.67 -0.67 -0.67 -0.67  3.33</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw">SigmaKstar</span>(fit), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;       L1    L2    L3    L4    L5    L6</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; L1  3.43 -0.68 -0.58 -0.81 -0.90 -0.46</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; L2 -0.68  3.42 -0.70 -0.70 -0.64 -0.71</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; L3 -0.58 -0.70  3.50 -0.84 -0.72 -0.66</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; L4 -0.81 -0.70 -0.84  3.55 -0.42 -0.77</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; L5 -0.90 -0.64 -0.72 -0.42  3.22 -0.54</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; L6 -0.46 -0.71 -0.66 -0.77 -0.54  3.14</span></a></code></pre></div>
</div>
<div id="pattern-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#pattern-matrix" class="anchor"></a>Pattern matrix</h2>
<p>The parametric estimation requires a pattern matrix that describes the unknowns in the <code>SigmaK</code> matrix. This <code>SigmaK</code> matrix is the variance covariance matrix describing the variances (diagonal) associated with each landmark, and the covariances (off-diagonal) among the landmarks.</p>
<p>The pattern matrix can be constructed in R, but when the number of landmarks is high and variances are expected to differ among the landmarks, it might be easier to construct the pattern matrix in a spreadsheet editor (Excel). Here is how the file should be constructed (the package contains example files, see <code>?read_pattern</code>):</p>
<ul>
<li>the 1st row describes the landmarks starting from the 2nd column,</li>
<li>the 1st column describes the landmarks in the same order as the column headers,</li>
<li>leave the cell in the topleft corner empty,</li>
<li>use unique names or numbers in the rest of the table to denote unique variables in the Sigma matrix,</li>
<li>structural zeros (cells where the covariance is known or assumed to be 0) have to be blank,</li>
<li>there cannot be blank cells in the diagonal of the matrix,</li>
<li>values below and above the diagonal must be symmetric (value in row 2/column 3 must be the same as row 3/column 2), either unique names or numbers, or blank.</li>
</ul>
<p>The pattern matrix for the equal variance case looks like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">p &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">    <span class="ot">NA</span>, <span class="st">"1"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">    <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"1"</span>, <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">    <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="st">"1"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">    <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"1"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">    <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"1"</span>),</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  <span class="dt">nrow=</span><span class="dv">6</span>, <span class="dt">ncol=</span><span class="dv">6</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(p) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M), <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M))</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">p</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;    L1  L2  L3  L4  L5  L6 </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; L1 "1" NA  NA  NA  NA  NA </span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; L2 NA  "1" NA  NA  NA  NA </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; L3 NA  NA  "1" NA  NA  NA </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; L4 NA  NA  NA  "1" NA  NA </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; L5 NA  NA  NA  NA  "1" NA </span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; L6 NA  NA  NA  NA  NA  "1"</span></a></code></pre></div>
</div>
<div id="parametric-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#parametric-estimation" class="anchor"></a>Parametric estimation</h2>
<p>The parametric estimation requires the fitted object from the previous step of nonparamatric estimation (that gave us the estimate of the mean form and SigmaKstar), and the pattern matrix, so that the program knows what parameters to estimate and where those are placed in the SigmaK matrix:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">(o &lt;-<span class="st"> </span><span class="kw">SigmaK_fit</span>(fit, p))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; EDMA parametric fit: Simulated landmark data</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; Call: SigmaK_fit(object = fit, pattern = p)</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; 2 dimensions, 6 landmarks, 1000 replicates, no bootstrap</span></a></code></pre></div>
<p>Now let us compare the ‘true’ SigmaK matrix with the estimated one:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">SigmaK              <span class="co"># true</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt;    L1 L2 L3 L4 L5 L6</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; L1  4  0  0  0  0  0</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; L2  0  4  0  0  0  0</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; L3  0  0  4  0  0  0</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; L4  0  0  0  4  0  0</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; L5  0  0  0  0  4  0</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; L6  0  0  0  0  0  4</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw">SigmaK</span>(o), <span class="dv">2</span>) <span class="co"># estimate</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt;      L1   L2   L3   L4   L5   L6</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; L1 0.44 0.00 0.00 0.00 0.00 0.00</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; L2 0.00 0.44 0.00 0.00 0.00 0.00</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt; L3 0.00 0.00 0.44 0.00 0.00 0.00</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt; L4 0.00 0.00 0.00 0.44 0.00 0.00</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; L5 0.00 0.00 0.00 0.00 0.44 0.00</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; L6 0.00 0.00 0.00 0.00 0.00 0.44</span></a></code></pre></div>
</div>
<div id="sensitivity-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#sensitivity-analysis" class="anchor"></a>Sensitivity analysis</h2>
<p>The parametric estimate is based on an optimization algorithm. This algorithm requires starting values for the unknown parameters. If a given parametric model’s parameters are estimable, we end up with the exact same estimates no matter what starting values we use. This can be used to check the estimability of our parameters. The <code>sensitivity</code> function repeats the parametric estimation multiple times using different starting values:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">(s &lt;-<span class="st"> </span><span class="kw">sensitivity</span>(o))</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt;           par_1         value</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;  [1,] 0.4401338 5.643803e+102</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt;  [2,] 0.3985179 5.643803e+102</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt;  [3,] 0.7884170 5.643803e+102</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt;  [4,] 0.5255732 5.643803e+102</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt;  [5,] 0.1176695 5.643803e+102</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt;  [6,] 0.4124452 5.643803e+102</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;  [7,] 0.6666336 5.643803e+102</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt;  [8,] 0.4514854 5.643803e+102</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;  [9,] 0.5857973 5.643803e+102</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; [10,] 0.7051549 5.643803e+102</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt; [11,] 0.8317974 5.643803e+102</span></a></code></pre></div>
<p>The <code>par_1</code> column shows the parameter estimates for the variance, the <code>value</code> column shows the value of the loss function evaluated at <code>par_1</code>. Both these values are constant, which is a sign of estimability.</p>
</div>
<div id="unequal-variance-case" class="section level2">
<h2 class="hasAnchor">
<a href="#unequal-variance-case" class="anchor"></a>Unequal variance case</h2>
<p>In the unequal variance case we can have different variances for the different landmarks. Here is the corresponding pattern matrix:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">p &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>, <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">    <span class="ot">NA</span>, <span class="st">"2"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">    <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="st">"3"</span>, <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">    <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="st">"4"</span>, <span class="ot">NA</span>,  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">    <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"5"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">    <span class="ot">NA</span>,  <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="ot">NA</span>,  <span class="ot">NA</span>, <span class="st">"6"</span>),</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">  <span class="dt">nrow=</span><span class="dv">6</span>, <span class="dt">ncol=</span><span class="dv">6</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(p) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M), <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M))</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">p</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt;    L1  L2  L3  L4  L5  L6 </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; L1 "1" NA  NA  NA  NA  NA </span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; L2 NA  "2" NA  NA  NA  NA </span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; L3 NA  NA  "3" NA  NA  NA </span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; L4 NA  NA  NA  "4" NA  NA </span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; L5 NA  NA  NA  NA  "5" NA </span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; L6 NA  NA  NA  NA  NA  "6"</span></a></code></pre></div>
<p>The SigmaK matrix looks like this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">parm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>=<span class="dv">12</span>, <span class="st">"2"</span>=<span class="dv">1</span>, <span class="st">"3"</span>=<span class="fl">1.1</span>, <span class="st">"4"</span>=<span class="dv">2</span>, <span class="st">"5"</span>=<span class="dv">8</span>, <span class="st">"6"</span>=<span class="fl">7.9</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">SigmaK &lt;-<span class="st"> </span>EDMAinR<span class="op">:::</span><span class="kw">.vec2mat</span>(parm, EDMAinR<span class="op">:::</span><span class="kw">.mat2fac</span>(p))</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">SigmaK</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; [1,]   12    0  0.0    0    0  0.0</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; [2,]    0    1  0.0    0    0  0.0</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; [3,]    0    0  1.1    0    0  0.0</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; [4,]    0    0  0.0    2    0  0.0</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; [5,]    0    0  0.0    0    8  0.0</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; [6,]    0    0  0.0    0    0  7.9</span></a></code></pre></div>
<p>The unequal variances translate to the following simulated data:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw">edma_simulate_data</span>(<span class="dt">n=</span>n, M, SigmaK)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">EDMAinR<span class="op">:::</span><span class="kw">.plot_edma_data</span>(sim, <span class="ot">NULL</span>, <span class="dt">asp=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">  <span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">80</span>, <span class="dv">100</span>), <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">60</span>, <span class="dv">60</span>))</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(M[,<span class="dv">1</span>]<span class="op">-</span><span class="dv">15</span>, M[,<span class="dv">2</span>], <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"L"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">cex=</span><span class="fl">0.6</span>, <span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="edma03-parametric_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>We can see the different sizes of the convex hulls corresponding to the variances for each landmark.</p>
<p>For the estimation, we use <code>edma_fit</code> and <code>SigmaK_fit</code> as before, but instead of the default optimization algorithm (Nelder-Mead simplex), we use simulated annealing (SANN) that works better for this parametrization:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">fit &lt;-<span class="st"> </span><span class="kw">edma_fit</span>(sim)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">o &lt;-<span class="st"> </span><span class="kw">SigmaK_fit</span>(fit, p, <span class="dt">method=</span><span class="st">"SANN"</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">SigmaK              <span class="co"># true</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; [1,]   12    0  0.0    0    0  0.0</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; [2,]    0    1  0.0    0    0  0.0</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; [3,]    0    0  1.1    0    0  0.0</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; [4,]    0    0  0.0    2    0  0.0</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; [5,]    0    0  0.0    0    8  0.0</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; [6,]    0    0  0.0    0    0  7.9</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw">SigmaK</span>(o), <span class="dv">2</span>) <span class="co"># estimate</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt;      L1   L2    L3   L4    L5     L6</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; L1 9.18 0.00  0.00  0.0  0.00   0.00</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; L2 0.00 3.23  0.00  0.0  0.00   0.00</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; L3 0.00 0.00 25.49  0.0  0.00   0.00</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; L4 0.00 0.00  0.00 24.5  0.00   0.00</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; L5 0.00 0.00  0.00  0.0 -4.21   0.00</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; L6 0.00 0.00  0.00  0.0  0.00 -24.35</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(s &lt;-<span class="st"> </span><span class="kw">sensitivity</span>(o), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt;         par_1   par_2   par_3   par_4   par_5   par_6         value</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt;  [1,]   9.181   3.229  25.487  24.501  -4.215 -24.351 5.643803e+102</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">#&gt;  [2,]   4.907 -12.152   7.059   5.814   3.453 -19.530 5.643803e+102</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">#&gt;  [3,] -16.308   3.095   2.036   3.316  -9.406 -15.963 5.643803e+102</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="co">#&gt;  [4,]  -9.512   9.655  16.898 -12.346 -22.157  -4.138 5.643803e+102</span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25"><span class="co">#&gt;  [5,]  -2.209  -7.103 -20.501  -3.192  -3.303 -15.890 5.643803e+102</span></a>
<a class="sourceLine" id="cb14-26" data-line-number="26"><span class="co">#&gt;  [6,]   5.316   4.161   3.819   9.927   7.388 -15.992 5.643803e+102</span></a>
<a class="sourceLine" id="cb14-27" data-line-number="27"><span class="co">#&gt;  [7,]   4.483 -12.390 -10.714 -25.580   4.958   5.675 5.643803e+102</span></a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="co">#&gt;  [8,]   5.020   0.705   2.917  -1.615  -1.360  14.856 5.643803e+102</span></a>
<a class="sourceLine" id="cb14-29" data-line-number="29"><span class="co">#&gt;  [9,]  -0.276  -4.518   6.936 -12.167  -8.921 -11.388 5.643803e+102</span></a>
<a class="sourceLine" id="cb14-30" data-line-number="30"><span class="co">#&gt; [10,]   5.251   3.209   4.536   0.159  12.265   1.108 5.643803e+102</span></a>
<a class="sourceLine" id="cb14-31" data-line-number="31"><span class="co">#&gt; [11,]  -1.019   7.724  11.794  -3.930   4.339  -0.525 5.643803e+102</span></a></code></pre></div>
</div>
<div id="non-estimable-case" class="section level2">
<h2 class="hasAnchor">
<a href="#non-estimable-case" class="anchor"></a>Non-estimable case</h2>
<p>The following parametrization is non identifiable:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">p &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>,</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">    <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>,</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">    <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>,</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">    <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>,</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">    <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>,</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">    <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>),</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">  <span class="dt">nrow=</span><span class="dv">6</span>, <span class="dt">ncol=</span><span class="dv">6</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(p) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M), <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(M))</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">p</a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt;    L1  L2  L3  L4  L5  L6 </span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt; L1 "1" "2" "2" "2" "2" "2"</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#&gt; L2 "2" "1" "2" "2" "2" "2"</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="co">#&gt; L3 "2" "2" "1" "2" "2" "2"</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">#&gt; L4 "2" "2" "2" "1" "2" "2"</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">#&gt; L5 "2" "2" "2" "2" "1" "2"</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">#&gt; L6 "2" "2" "2" "2" "2" "1"</span></a></code></pre></div>
<p>The diagonal elements are <span class="math inline">\(\sigma^2\)</span> (equal variance), the off diagonal elements are <span class="math inline">\(\sigma^2\rho\)</span> where <span class="math inline">\(\rho\)</span> is the correlation:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">parm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>=<span class="dv">10</span>, <span class="st">"2"</span>=<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">SigmaK &lt;-<span class="st"> </span>EDMAinR<span class="op">:::</span><span class="kw">.vec2mat</span>(parm, EDMAinR<span class="op">:::</span><span class="kw">.mat2fac</span>(p))</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">SigmaK</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#&gt; [1,]   10    2    2    2    2    2</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt; [2,]    2   10    2    2    2    2</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; [3,]    2    2   10    2    2    2</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt; [4,]    2    2    2   10    2    2</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">#&gt; [5,]    2    2    2    2   10    2</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt; [6,]    2    2    2    2    2   10</span></a></code></pre></div>
<p>The correlation lead to more ellipsoid shapes for the simulated landmarks:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw">edma_simulate_data</span>(<span class="dt">n=</span>n, M, SigmaK)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">EDMAinR<span class="op">:::</span><span class="kw">.plot_edma_data</span>(sim, <span class="ot">NULL</span>, <span class="dt">asp=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">  <span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">80</span>, <span class="dv">100</span>), <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">60</span>, <span class="dv">60</span>))</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(M[,<span class="dv">1</span>]<span class="op">-</span><span class="dv">15</span>, M[,<span class="dv">2</span>], <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"L"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">cex=</span><span class="fl">0.6</span>, <span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="edma03-parametric_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">fit &lt;-<span class="st"> </span><span class="kw">edma_fit</span>(sim)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">o &lt;-<span class="st"> </span><span class="kw">SigmaK_fit</span>(fit, p, <span class="dt">method=</span><span class="st">"SANN"</span>)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">SigmaK              <span class="co"># true</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#&gt; [1,]   10    2    2    2    2    2</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#&gt; [2,]    2   10    2    2    2    2</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt; [3,]    2    2   10    2    2    2</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt; [4,]    2    2    2   10    2    2</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; [5,]    2    2    2    2   10    2</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt; [6,]    2    2    2    2    2   10</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw">SigmaK</span>(o), <span class="dv">2</span>) <span class="co"># estimate</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt;        L1     L2     L3     L4     L5     L6</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; L1 -11.65 -11.34 -11.34 -11.34 -11.34 -11.34</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">#&gt; L2 -11.34 -11.65 -11.34 -11.34 -11.34 -11.34</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">#&gt; L3 -11.34 -11.34 -11.65 -11.34 -11.34 -11.34</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="co">#&gt; L4 -11.34 -11.34 -11.34 -11.65 -11.34 -11.34</span></a>
<a class="sourceLine" id="cb18-17" data-line-number="17"><span class="co">#&gt; L5 -11.34 -11.34 -11.34 -11.34 -11.65 -11.34</span></a>
<a class="sourceLine" id="cb18-18" data-line-number="18"><span class="co">#&gt; L6 -11.34 -11.34 -11.34 -11.34 -11.34 -11.65</span></a>
<a class="sourceLine" id="cb18-19" data-line-number="19">(s &lt;-<span class="st"> </span><span class="kw">sensitivity</span>(o))</a>
<a class="sourceLine" id="cb18-20" data-line-number="20"><span class="co">#&gt;            par_1       par_2         value</span></a>
<a class="sourceLine" id="cb18-21" data-line-number="21"><span class="co">#&gt;  [1,] -11.653871 -11.3372765 5.643803e+102</span></a>
<a class="sourceLine" id="cb18-22" data-line-number="22"><span class="co">#&gt;  [2,]   1.319210  -4.3866389 5.643803e+102</span></a>
<a class="sourceLine" id="cb18-23" data-line-number="23"><span class="co">#&gt;  [3,]  -8.655320  -9.4474586 5.643803e+102</span></a>
<a class="sourceLine" id="cb18-24" data-line-number="24"><span class="co">#&gt;  [4,]   1.836849   0.1897185 5.643803e+102</span></a>
<a class="sourceLine" id="cb18-25" data-line-number="25"><span class="co">#&gt;  [5,] -11.835870  23.1272947 5.643803e+102</span></a>
<a class="sourceLine" id="cb18-26" data-line-number="26"><span class="co">#&gt;  [6,]   1.141882 -16.0226964 5.643803e+102</span></a>
<a class="sourceLine" id="cb18-27" data-line-number="27"><span class="co">#&gt;  [7,]  18.991289 -18.2062682 5.643803e+102</span></a>
<a class="sourceLine" id="cb18-28" data-line-number="28"><span class="co">#&gt;  [8,]  25.718720  -0.3432481 5.643803e+102</span></a>
<a class="sourceLine" id="cb18-29" data-line-number="29"><span class="co">#&gt;  [9,]  -4.798475 -14.6528967 5.643803e+102</span></a>
<a class="sourceLine" id="cb18-30" data-line-number="30"><span class="co">#&gt; [10,]   9.929005  10.8447888 5.643803e+102</span></a>
<a class="sourceLine" id="cb18-31" data-line-number="31"><span class="co">#&gt; [11,] -16.027089   8.0572981 5.643803e+102</span></a></code></pre></div>
<p>The sensitivity analysis reveals that we get different estimates when using different starting values. Although the estimates differ greatly, the loss function values are identical. Therefore, we cannot decide which estimate is the best, these are equally bad, i.e. non-estimable.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#simulated-landmark-data">Simulated landmark data</a></li>
      <li><a href="#nonparametruc-estimation">Nonparametruc estimation</a></li>
      <li><a href="#pattern-matrix">Pattern matrix</a></li>
      <li><a href="#parametric-estimation">Parametric estimation</a></li>
      <li><a href="#sensitivity-analysis">Sensitivity analysis</a></li>
      <li><a href="#unequal-variance-case">Unequal variance case</a></li>
      <li><a href="#non-estimable-case">Non-estimable case</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Peter Solymos, Subhash R. Lele, Theodore M. Cole, Liangyuan Hu, Joan T. Richtsmeier.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
